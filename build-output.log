ğŸ“ Using git commit hash as image tag: c0517b8
ğŸ’¾ Using thumbdrive: /Volumes/pi-site
ğŸ³ Building ARM64 Docker image (tag: c0517b8)...
#0 building with "pi-site-builder" instance using docker-container driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 3.30kB done
#1 DONE 0.0s

#2 [auth] library/node:pull token for registry-1.docker.io
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/node:22-alpine
#3 DONE 0.8s

#4 [internal] load .dockerignore
#4 transferring context: 643B done
#4 DONE 0.0s

#5 [builder  1/12] FROM docker.io/library/node:22-alpine@sha256:0340fa682d72068edf603c305bfbc10e23219fb0e40df58d9ea4d6f33a9798bf
#5 resolve docker.io/library/node:22-alpine@sha256:0340fa682d72068edf603c305bfbc10e23219fb0e40df58d9ea4d6f33a9798bf done
#5 DONE 0.0s

#6 [internal] load build context
#6 transferring context: 11.82kB 0.0s done
#6 DONE 0.0s

#7 [builder  2/12] RUN apk update &&     apk add --no-cache         python3         make         g++         openssl         sqlite-dev     && rm -rf /var/cache/apk/*
#7 CACHED

#8 [builder  3/12] WORKDIR /app
#8 CACHED

#9 [builder  4/12] COPY package.json package-lock.json* ./
#9 CACHED

#10 [builder  5/12] RUN npm ci
#10 CACHED

#11 [builder  7/12] COPY prisma.config.ts ./
#11 CACHED

#12 [builder  6/12] COPY prisma ./prisma
#12 CACHED

#13 [builder  8/12] RUN npx prisma generate
#13 CACHED

#14 [builder  9/12] COPY . .
#14 DONE 0.0s

#15 [builder 10/12] RUN npm run build
#15 0.141 
#15 0.141 > pi-site@0.1.0 build
#15 0.141 > next build
#15 0.141 
#15 0.567    â–² Next.js 15.5.9
#15 0.568    - Experiments (use with caution):
#15 0.568      Â· serverActions
#15 0.568 
#15 0.584    Creating an optimized production build ...
#15 8.216  âœ“ Compiled successfully in 6.5s
#15 8.218    Linting and checking validity of types ...
#15 10.41    Collecting page data ...
#15 11.40    Generating static pages (0/7) ...
#15 11.61    Generating static pages (1/7) 
#15 11.72    Generating static pages (3/7) 
#15 11.72    Generating static pages (5/7) 
#15 11.72  âœ“ Generating static pages (7/7)
#15 12.11    Finalizing page optimization ...
#15 12.11    Collecting build traces ...
#15 19.99 
#15 20.00 Route (app)                                 Size  First Load JS
#15 20.00 â”Œ â—‹ /                                    5.94 kB         122 kB
#15 20.00 â”œ â—‹ /_not-found                            991 B         103 kB
#15 20.00 â”œ â—‹ /about                               13.1 kB         131 kB
#15 20.00 â”œ Æ’ /api/assets/[...dir]                   130 B         102 kB
#15 20.00 â”œ Æ’ /api/auth/[...nextauth]                130 B         102 kB
#15 20.00 â”œ Æ’ /api/health                            130 B         102 kB
#15 20.00 â”” Æ’ /stats                                1.8 kB         111 kB
#15 20.00 + First Load JS shared by all             102 kB
#15 20.00   â”œ chunks/255-cb395327542b56ef.js       45.9 kB
#15 20.00   â”œ chunks/4bd1b696-c023c6e3521b1417.js  54.2 kB
#15 20.00   â”” other shared chunks (total)          2.07 kB
#15 20.00 
#15 20.00 
#15 20.00 â—‹  (Static)   prerendered as static content
#15 20.00 Æ’  (Dynamic)  server-rendered on demand
#15 20.00 
#15 DONE 20.1s

#16 [builder 11/12] RUN if [ ! -d ".next/standalone" ] || [ ! -f ".next/standalone/server.js" ]; then         echo "ERROR: Standalone output not found! Check next.config.ts has output: 'standalone'" &&         ls -la .next/ || echo ".next directory does not exist" &&         exit 1;     fi &&     echo "âœ… Standalone output verified: server.js exists"
#16 0.049 âœ… Standalone output verified: server.js exists
#16 DONE 0.1s

#17 [builder 12/12] RUN npm prune --production
#17 0.109 npm warn config production Use `--omit=dev` instead.
#17 1.269 
#17 1.269 up to date, audited 357 packages in 1s
#17 1.269 
#17 1.269 61 packages are looking for funding
#17 1.269   run `npm fund` for details
#17 1.270 
#17 1.270 found 0 vulnerabilities
#17 DONE 1.3s

#18 [runner  3/12] RUN apk add --no-cache         openssl         sqlite-libs     && rm -rf /var/cache/apk/*
#18 CACHED

#19 [runner  2/12] WORKDIR /app
#19 CACHED

#20 [runner  4/12] RUN addgroup --system --gid 1001 nodejs &&     adduser --system --uid 1001 nextjs
#20 CACHED

#21 [runner  5/12] COPY --from=builder /app/.next/standalone ./
#21 DONE 0.2s

#22 [runner  6/12] COPY --from=builder /app/.next/static ./.next/static
#22 DONE 0.0s

#23 [runner  7/12] COPY --from=builder /app/public ./public
#23 DONE 0.0s

#24 [runner  8/12] RUN rm -rf /app/public/images
#24 DONE 0.0s

#25 [runner  9/12] COPY --from=builder /app/prisma ./prisma
#25 DONE 0.0s

#26 [runner 10/12] COPY --from=builder /app/node_modules/.prisma ./node_modules/.prisma
#26 DONE 0.0s

#27 [runner 11/12] RUN if [ ! -f "/app/server.js" ]; then         echo "ERROR: server.js not found after COPY! Listing /app contents:" &&         ls -la /app/ &&         echo "Checking if standalone was copied:" &&         ls -la /app/.next/standalone/ 2>/dev/null || echo ".next/standalone not found" &&         exit 1;     fi &&     echo "âœ… Verified: server.js exists at /app/server.js"
#27 0.038 âœ… Verified: server.js exists at /app/server.js
#27 DONE 0.0s

#28 [runner 12/12] RUN mkdir -p /app/public/images /app/prisma &&     chown -R nextjs:nodejs /app
#28 DONE 1.1s

#29 exporting to docker image format
#29 exporting layers
#29 exporting layers 1.6s done
#29 exporting manifest sha256:8738a6b4716c75d842dc02a984d64d5f32872a2ed7fb2963cd8509788932dcb7
#29 exporting manifest sha256:8738a6b4716c75d842dc02a984d64d5f32872a2ed7fb2963cd8509788932dcb7 done
#29 exporting config sha256:898ca7d6b1cfa9f72cc411e07638674b8f9410ef5c05f3926256b0b2f6610129 done
#29 sending tarball
#29 sending tarball 0.7s done
#29 DONE 2.2s

View build details: docker-desktop://dashboard/build/pi-site-builder/pi-site-builder0/tumd8u8db5v936m1th5tmn8zm
âœ… Image built successfully! Size: 128M
ğŸ’¾ Copying image to thumbdrive...
âœ… Image copied to thumbdrive!

ğŸ“‹ Next steps on your Raspberry Pi:
   1. Safely eject the thumbdrive from your Mac
   2. Insert the thumbdrive into your Raspberry Pi
   3. The Pi will usually auto-mount it (check with: lsblk)
   4. Load the image using the helper script:
      cd ~/pi-site && bash scripts/load-from-thumbdrive.sh

   Or manually:
      docker load -i /media/pi/USB_DRIVE/pi-site-c0517b8.tar
      cd ~/pi-site && docker compose up -d

ğŸ“ Image file location: /Volumes/pi-site/pi-site-c0517b8.tar
   (Just this ONE file needs to be on the thumbdrive)
âœ… Image transferred successfully!

   Image: pi-site:c0517b8
   Also tagged as: pi-site:latest

On your Pi, you can now run:
  docker compose up -d
